{"version":3,"file":"actionModal-spzSe_pg.js","names":["initialContext: ActionModalState","event: { chainId: number; collectionAddress: Address }","chainId: number","collectionAddress: Address"],"sources":["../src/react/ui/modals/_internal/components/actionModal/ActionModal.tsx","../src/react/ui/modals/_internal/components/actionModal/store.ts"],"sourcesContent":["'use client';\n\nimport { Button, Modal, Spinner, Text } from '@0xsequence/design-system';\nimport type React from 'react';\nimport type { ComponentProps } from 'react';\nimport { useWallet } from '../../../../../_internal/wallet/useWallet';\nimport { MODAL_CONTENT_PROPS, MODAL_OVERLAY_PROPS } from '../consts';\nimport { useSwitchChainModal } from '../switchChainModal';\n\nexport interface ActionModalProps {\n\tisOpen: boolean;\n\tonClose: () => void;\n\ttitle: string;\n\tchildren: React.ReactNode;\n\tctas: {\n\t\tlabel: React.ReactNode;\n\t\tonClick: (() => Promise<void>) | (() => void);\n\t\tpending?: boolean;\n\t\tdisabled?: boolean;\n\t\thidden?: boolean;\n\t\tvariant?: ComponentProps<typeof Button>['variant'];\n\t\ttestid?: string;\n\t}[];\n\tchainId: number;\n\tmodalLoading?: boolean;\n\tspinnerContainerClassname?: string;\n\tdisableAnimation?: boolean;\n\thideCtas?: boolean;\n}\n\nexport const ActionModal = ({\n\tisOpen,\n\tonClose,\n\ttitle,\n\tchildren,\n\tctas,\n\tchainId,\n\tdisableAnimation,\n\tmodalLoading,\n\tspinnerContainerClassname,\n\thideCtas,\n}: ActionModalProps) => {\n\tconst { show: showSwitchChainModal } = useSwitchChainModal();\n\tconst { wallet, isLoading, isError } = useWallet();\n\n\tconst checkChain = async ({ onSuccess }: { onSuccess: () => void }) => {\n\t\tconst walletChainId = await wallet?.getChainId();\n\t\tconst chainMismatch = walletChainId !== Number(chainId);\n\t\tif (chainMismatch) {\n\t\t\tshowSwitchChainModal({\n\t\t\t\tchainIdToSwitchTo: chainId,\n\t\t\t\tonSuccess,\n\t\t\t});\n\t\t} else {\n\t\t\tonSuccess();\n\t\t}\n\t};\n\n\tif (wallet?.isWaaS) {\n\t\twallet.switchChain(Number(chainId));\n\t}\n\n\tif (!isOpen || !chainId) {\n\t\treturn null;\n\t}\n\n\treturn (\n\t\t<Modal\n\t\t\tisDismissible={true}\n\t\t\tonClose={onClose}\n\t\t\toverlayProps={MODAL_OVERLAY_PROPS}\n\t\t\tcontentProps={MODAL_CONTENT_PROPS}\n\t\t\tdisableAnimation={disableAnimation}\n\t\t>\n\t\t\t<div className=\"relative flex grow flex-col items-center gap-4 p-6\">\n\t\t\t\t<Text className=\"w-full text-center font-body font-bold text-large text-text-100\">\n\t\t\t\t\t{title}\n\t\t\t\t</Text>\n\n\t\t\t\t{modalLoading || isLoading || isError ? (\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName={`flex ${spinnerContainerClassname} w-full items-center justify-center`}\n\t\t\t\t\t\tdata-testid=\"error-loading-wrapper\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{isError && (\n\t\t\t\t\t\t\t<Text\n\t\t\t\t\t\t\t\tdata-testid=\"error-loading-text\"\n\t\t\t\t\t\t\t\tclassName=\"text-center font-body text-error100 text-small\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tError loading modal\n\t\t\t\t\t\t\t</Text>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{(isLoading || modalLoading) && (\n\t\t\t\t\t\t\t<div data-testid=\"spinner\">\n\t\t\t\t\t\t\t\t<Spinner size=\"lg\" />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t) : (\n\t\t\t\t\tchildren\n\t\t\t\t)}\n\n\t\t\t\t{!hideCtas && !isLoading && !isError && (\n\t\t\t\t\t<div className=\"flex w-full flex-col gap-2\">\n\t\t\t\t\t\t{ctas.map(\n\t\t\t\t\t\t\t(cta) =>\n\t\t\t\t\t\t\t\t!cta.hidden && (\n\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\tclassName=\"w-full rounded-[12px] [&>div]:justify-center\"\n\t\t\t\t\t\t\t\t\t\tkey={cta.onClick.toString()}\n\t\t\t\t\t\t\t\t\t\tonClick={async () => {\n\t\t\t\t\t\t\t\t\t\t\tawait checkChain({\n\t\t\t\t\t\t\t\t\t\t\t\tonSuccess: () => {\n\t\t\t\t\t\t\t\t\t\t\t\t\tcta.onClick();\n\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\tvariant={cta.variant || 'primary'}\n\t\t\t\t\t\t\t\t\t\tpending={cta.pending}\n\t\t\t\t\t\t\t\t\t\tdisabled={cta.disabled}\n\t\t\t\t\t\t\t\t\t\tsize=\"lg\"\n\t\t\t\t\t\t\t\t\t\tdata-testid={cta.testid}\n\t\t\t\t\t\t\t\t\t\tlabel={\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center justify-center gap-2\">\n\t\t\t\t\t\t\t\t\t\t\t\t{cta.pending && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div data-testid={`${cta.testid}-spinner`}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Spinner size=\"sm\" />\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t\t\t\t\t\t\t{cta.label}\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t</Modal>\n\t);\n};\n","import { createStore } from '@xstate/store';\nimport { useSelector } from '@xstate/store/react';\nimport type { Address } from 'viem';\n\nexport interface ActionModalState {\n\tisOpen: boolean;\n\tchainId: number | null;\n\tcollectionAddress: Address | null;\n}\n\nconst initialContext: ActionModalState = {\n\tisOpen: false,\n\tchainId: null,\n\tcollectionAddress: null,\n};\n\nexport const actionModalStore = createStore({\n\tcontext: initialContext,\n\ton: {\n\t\topen: (\n\t\t\tcontext,\n\t\t\tevent: { chainId: number; collectionAddress: Address },\n\t\t) => ({\n\t\t\t...context,\n\t\t\tisOpen: true,\n\t\t\tchainId: event.chainId,\n\t\t\tcollectionAddress: event.collectionAddress,\n\t\t}),\n\t\tclose: (context) => ({\n\t\t\t...context,\n\t\t\tisOpen: false,\n\t\t\tchainId: null,\n\t\t\tcollectionAddress: null,\n\t\t}),\n\t},\n});\n\n// Selector hooks\nexport const useActionModalState = () =>\n\tuseSelector(actionModalStore, (state) => state.context);\n\nexport const useIsActionModalOpen = () =>\n\tuseSelector(actionModalStore, (state) => state.context.isOpen);\n\nexport const useActionModalChainId = () =>\n\tuseSelector(actionModalStore, (state) => state.context.chainId);\n\nexport const useActionModalCollectionAddress = () =>\n\tuseSelector(actionModalStore, (state) => state.context.collectionAddress);\n\nexport function openModal(chainId: number, collectionAddress: Address) {\n\tactionModalStore.send({ type: 'open', chainId, collectionAddress });\n}\n\nexport function closeModal() {\n\tactionModalStore.send({ type: 'close' });\n}\n"],"mappings":";;;;;;;;AA8BA,MAAa,cAAc,CAAC,EAC3B,QACA,SACA,OACA,UACA,MACA,SACA,kBACA,cACA,2BACA,UACkB,KAAK;CACvB,MAAM,EAAE,MAAM,sBAAsB,GAAG,qBAAqB;CAC5D,MAAM,EAAE,QAAQ,WAAW,SAAS,GAAG,WAAW;CAElD,MAAM,aAAa,OAAO,EAAE,WAAsC,KAAK;EACtE,MAAM,gBAAgB,MAAM,QAAQ,YAAY;EAChD,MAAM,gBAAgB,kBAAkB,OAAO,QAAQ;AACvD,MAAI,cACH,sBAAqB;GACpB,mBAAmB;GACnB;EACA,EAAC;MAEF,YAAW;CAEZ;AAED,KAAI,QAAQ,OACX,QAAO,YAAY,OAAO,QAAQ,CAAC;AAGpC,MAAK,WAAW,QACf,QAAO;AAGR,wBACC,IAAC;EACA,eAAe;EACN;EACT,cAAc;EACd,cAAc;EACI;4BAElB,KAAC;GAAI,WAAU;;oBACd,IAAC;KAAK,WAAU;eACd;MACK;IAEN,gBAAgB,aAAa,0BAC7B,KAAC;KACA,YAAY,OAAO,0BAA0B;KAC7C,eAAY;gBAEX,2BACA,IAAC;MACA,eAAY;MACZ,WAAU;gBACV;OAEM,GAEN,aAAa,iCACd,IAAC;MAAI,eAAY;gCAChB,IAAC,WAAQ,MAAK,OAAO;OAChB;MAEF,GAEN;KAGC,aAAa,cAAc,2BAC5B,IAAC;KAAI,WAAU;eACb,KAAK,IACL,CAAC,SACC,IAAI,0BACJ,IAAC;MACA,WAAU;MAEV,SAAS,YAAY;AACpB,aAAM,WAAW,EAChB,WAAW,MAAM;AAChB,YAAI,SAAS;OACb,EACD,EAAC;MACF;MACD,SAAS,IAAI,WAAW;MACxB,SAAS,IAAI;MACb,UAAU,IAAI;MACd,MAAK;MACL,eAAa,IAAI;MACjB,uBACC,KAAC;OAAI,WAAU;kBACb,IAAI,2BACJ,IAAC;QAAI,gBAAc,EAAE,IAAI,OAAO;kCAC/B,IAAC,WAAQ,MAAK,OAAO;SAChB,EAGN,IAAI;QACA;QAtBF,IAAI,QAAQ,UAAU,CAwB1B,CAEJ;MACI;;IAEF;GACC;AAET;;;;ACnID,MAAMA,iBAAmC;CACxC,QAAQ;CACR,SAAS;CACT,mBAAmB;AACnB;AAED,MAAa,mBAAmB,YAAY;CAC3C,SAAS;CACT,IAAI;EACH,MAAM,CACL,SACAC,WACK;GACL,GAAG;GACH,QAAQ;GACR,SAAS,MAAM;GACf,mBAAmB,MAAM;EACzB;EACD,OAAO,CAAC,aAAa;GACpB,GAAG;GACH,QAAQ;GACR,SAAS;GACT,mBAAmB;EACnB;CACD;AACD,EAAC;AAGF,MAAa,sBAAsB,MAClC,YAAY,kBAAkB,CAAC,UAAU,MAAM,QAAQ;AAExD,MAAa,uBAAuB,MACnC,YAAY,kBAAkB,CAAC,UAAU,MAAM,QAAQ,OAAO;AAE/D,MAAa,wBAAwB,MACpC,YAAY,kBAAkB,CAAC,UAAU,MAAM,QAAQ,QAAQ;AAEhE,MAAa,kCAAkC,MAC9C,YAAY,kBAAkB,CAAC,UAAU,MAAM,QAAQ,kBAAkB;AAE1E,SAAgB,UAAUC,SAAiBC,mBAA4B;AACtE,kBAAiB,KAAK;EAAE,MAAM;EAAQ;EAAS;CAAmB,EAAC;AACnE;AAED,SAAgB,aAAa;AAC5B,kBAAiB,KAAK,EAAE,MAAM,QAAS,EAAC;AACxC"}