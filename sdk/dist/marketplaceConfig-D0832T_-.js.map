{"version":3,"file":"marketplaceConfig-D0832T_-.js","names":["config: SdkConfig"],"sources":["../src/react/queries/marketplaceConfig.ts"],"sourcesContent":["import { queryOptions } from '@tanstack/react-query';\nimport type { ContractType, SdkConfig } from '../../types';\nimport type {\n\tMarketCollection,\n\tMarketPage,\n\tMarketplaceConfig,\n\tShopCollection,\n\tShopPage,\n} from '../../types/new-marketplace-types';\nimport { configKeys, getBuilderClient } from '../_internal';\nimport type { LookupMarketplaceReturn } from '../_internal/api/builder.gen';\n\nexport const fetchMarketplaceConfig = async ({\n\tconfig,\n\tprefetchedMarketplaceSettings,\n}: {\n\tconfig: SdkConfig;\n\tprefetchedMarketplaceSettings?: LookupMarketplaceReturn;\n}): Promise<MarketplaceConfig> => {\n\tlet builderMarketplaceConfig = prefetchedMarketplaceSettings;\n\n\tif (!builderMarketplaceConfig) {\n\t\tconst builderApi = getBuilderClient(config);\n\t\tconst response = await builderApi.lookupMarketplace({\n\t\t\tprojectId: Number(config.projectId),\n\t\t});\n\n\t\tbuilderMarketplaceConfig = response;\n\t}\n\n\tconst marketCollections = (\n\t\tbuilderMarketplaceConfig.marketCollections ?? []\n\t).map((collection) => {\n\t\treturn {\n\t\t\t...collection,\n\t\t\tcontractType: collection.contractType as ContractType,\n\t\t\tmarketplaceType: 'market',\n\t\t} satisfies MarketCollection;\n\t});\n\n\tconst shopCollections = (builderMarketplaceConfig.shopCollections ?? []).map(\n\t\t(collection) => {\n\t\t\treturn {\n\t\t\t\t...collection,\n\t\t\t\tmarketplaceType: 'shop',\n\t\t\t} satisfies ShopCollection;\n\t\t},\n\t);\n\n\tconst market = {\n\t\t...builderMarketplaceConfig.marketplace.market,\n\t\tcollections: marketCollections,\n\t} satisfies MarketPage;\n\n\tconst shop = {\n\t\t...builderMarketplaceConfig.marketplace.shop,\n\t\tcollections: shopCollections ?? [],\n\t} satisfies ShopPage;\n\n\tlet marketplaceConfig = {\n\t\tprojectId: Number(config.projectId),\n\t\tsettings: builderMarketplaceConfig.marketplace.settings,\n\t\tmarket,\n\t\tshop,\n\t} satisfies MarketplaceConfig;\n\n\tif (config._internal?.overrides?.marketplaceConfig) {\n\t\tconst overrides = config._internal.overrides.marketplaceConfig;\n\t\tmarketplaceConfig = {\n\t\t\t...marketplaceConfig,\n\t\t\t...overrides,\n\t\t\tmarket: {\n\t\t\t\t...marketplaceConfig.market,\n\t\t\t\t...overrides.market,\n\t\t\t\t//@ts-expect-error - TODO: Fix this partial type. We need to align new-marketplace-types with builder.gen.ts\n\t\t\t\tcollections:\n\t\t\t\t\toverrides.market?.collections ?? marketplaceConfig.market.collections,\n\t\t\t},\n\t\t\tshop: {\n\t\t\t\t...marketplaceConfig.shop,\n\t\t\t\t...overrides.shop,\n\t\t\t\t//@ts-expect-error - TODO: Fix this partial type. We need to align new-marketplace-types with builder.gen.ts\n\t\t\t\tcollections:\n\t\t\t\t\toverrides.shop?.collections ?? marketplaceConfig.shop.collections,\n\t\t\t},\n\t\t};\n\t}\n\n\treturn marketplaceConfig;\n};\n\nexport const marketplaceConfigOptions = (config: SdkConfig) => {\n\tconst prefetchedMarketplaceSettings =\n\t\tconfig._internal?.prefetchedMarketplaceSettings;\n\n\treturn queryOptions({\n\t\tqueryKey: [...configKeys.marketplace],\n\t\tqueryFn: () =>\n\t\t\tfetchMarketplaceConfig({\n\t\t\t\tconfig,\n\t\t\t\tprefetchedMarketplaceSettings,\n\t\t\t}),\n\t});\n};\n"],"mappings":";;;;AAYA,MAAa,yBAAyB,OAAO,EAC5C,QACA,+BAIA,KAAiC;CACjC,IAAI,2BAA2B;AAE/B,MAAK,0BAA0B;EAC9B,MAAM,aAAa,iBAAiB,OAAO;EAC3C,MAAM,WAAW,MAAM,WAAW,kBAAkB,EACnD,WAAW,OAAO,OAAO,UAAU,CACnC,EAAC;AAEF,6BAA2B;CAC3B;CAED,MAAM,oBAAoB,CACzB,yBAAyB,qBAAqB,CAAE,GAC/C,IAAI,CAAC,eAAe;AACrB,SAAO;GACN,GAAG;GACH,cAAc,WAAW;GACzB,iBAAiB;EACjB;CACD,EAAC;CAEF,MAAM,kBAAkB,CAAC,yBAAyB,mBAAmB,CAAE,GAAE,IACxE,CAAC,eAAe;AACf,SAAO;GACN,GAAG;GACH,iBAAiB;EACjB;CACD,EACD;CAED,MAAM,SAAS;EACd,GAAG,yBAAyB,YAAY;EACxC,aAAa;CACb;CAED,MAAM,OAAO;EACZ,GAAG,yBAAyB,YAAY;EACxC,aAAa,mBAAmB,CAAE;CAClC;CAED,IAAI,oBAAoB;EACvB,WAAW,OAAO,OAAO,UAAU;EACnC,UAAU,yBAAyB,YAAY;EAC/C;EACA;CACA;AAED,KAAI,OAAO,WAAW,WAAW,mBAAmB;EACnD,MAAM,YAAY,OAAO,UAAU,UAAU;AAC7C,sBAAoB;GACnB,GAAG;GACH,GAAG;GACH,QAAQ;IACP,GAAG,kBAAkB;IACrB,GAAG,UAAU;IAEb,aACC,UAAU,QAAQ,eAAe,kBAAkB,OAAO;GAC3D;GACD,MAAM;IACL,GAAG,kBAAkB;IACrB,GAAG,UAAU;IAEb,aACC,UAAU,MAAM,eAAe,kBAAkB,KAAK;GACvD;EACD;CACD;AAED,QAAO;AACP;AAED,MAAa,2BAA2B,CAACA,WAAsB;CAC9D,MAAM,gCACL,OAAO,WAAW;AAEnB,QAAO,aAAa;EACnB,UAAU,CAAC,GAAG,WAAW,WAAY;EACrC,SAAS,MACR,uBAAuB;GACtB;GACA;EACA,EAAC;CACH,EAAC;AACF"}