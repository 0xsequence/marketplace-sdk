{"version":3,"file":"provider-DPGUA10G.js","names":["projectAccessKey: string","args: TrackSellItems","args: TrackBuyModalOpened","args: TrackCreateListing","args: TrackCreateOffer","args: TrackTransactionFailed","auth: Auth","context: MarketplaceSdkContextType"],"sources":["../src/utils/_internal/error/config.ts","../src/react/_internal/databeat/index.ts","../src/react/provider.tsx"],"sourcesContent":["import { BaseError } from './base';\n\nexport type ConfigErrorType<name extends string = 'ConfigError'> = BaseError & {\n\tname: name;\n};\n\nexport class ConfigError extends BaseError {\n\toverride name = 'ConfigError';\n}\n\nexport class InvalidProjectAccessKeyError extends ConfigError {\n\toverride name = 'InvalidProjectAccessKeyError';\n\tconstructor(projectAccessKey: string) {\n\t\tsuper(`Invalid project access key: ${projectAccessKey}`);\n\t}\n}\n","import type { Event as DatabeatEvent } from '@databeat/tracker';\nimport { Databeat } from '@databeat/tracker';\nimport { useContext } from 'react';\n\nimport { MarketplaceSdkContext } from '../../provider';\nimport type {\n\tEventType,\n\tTrackBuyModalOpened,\n\tTrackCreateListing,\n\tTrackCreateOffer,\n\tTrackSellItems,\n\tTrackTransactionFailed,\n} from './types';\n\nexport type EventTypes = keyof typeof EventType;\nexport type Event = DatabeatEvent<EventTypes>;\n\nexport class DatabeatAnalytics extends Databeat<Extract<EventTypes, string>> {\n\ttrackSellItems(args: TrackSellItems) {\n\t\tthis.track({\n\t\t\tevent: 'SELL_ITEMS',\n\t\t\tprops: args.props,\n\t\t\tnums: args.nums,\n\t\t});\n\t}\n\n\ttrackBuyModalOpened(args: TrackBuyModalOpened) {\n\t\tthis.track({\n\t\t\tevent: 'BUY_MODAL_OPENED',\n\t\t\tprops: args.props,\n\t\t\tnums: args.nums,\n\t\t});\n\t}\n\n\ttrackCreateListing(args: TrackCreateListing) {\n\t\tthis.track({\n\t\t\tevent: 'CREATE_LISTING',\n\t\t\tprops: args.props,\n\t\t\tnums: args.nums,\n\t\t});\n\t}\n\n\ttrackCreateOffer(args: TrackCreateOffer) {\n\t\tthis.track({\n\t\t\tevent: 'CREATE_OFFER',\n\t\t\tprops: args.props,\n\t\t\tnums: args.nums,\n\t\t});\n\t}\n\n\ttrackTransactionFailed(args: TrackTransactionFailed) {\n\t\tthis.track({\n\t\t\tevent: 'TRANSACTION_FAILED',\n\t\t\tprops: args,\n\t\t});\n\t}\n}\n\nexport const useAnalytics = () => {\n\tconst context = useContext(MarketplaceSdkContext);\n\n\treturn context.analytics;\n};\n","'use client';\n\nimport { useOpenConnectModal } from '@0xsequence/connect';\nimport type { Auth } from '@databeat/tracker';\nimport { QueryClientProvider } from '@tanstack/react-query';\nimport { createContext, useMemo } from 'react';\nimport type {\n\tMarketplaceSdkContext as MarketplaceSdkContextType,\n\tSdkConfig,\n} from '../types';\nimport { InvalidProjectAccessKeyError } from '../utils/_internal/error/config';\nimport { getQueryClient } from './_internal/api/get-query-client';\nimport { DatabeatAnalytics } from './_internal/databeat';\nimport { PROVIDER_ID } from './_internal/get-provider';\n\nexport const MarketplaceSdkContext = createContext(\n\t{} as MarketplaceSdkContextType,\n);\n\nexport type MarketplaceSdkProviderProps = {\n\tconfig: SdkConfig;\n\tchildren: React.ReactNode;\n\topenConnectModal?: () => void;\n};\n\nexport function MarketplaceProvider({\n\tconfig,\n\tchildren,\n\topenConnectModal,\n}: MarketplaceSdkProviderProps) {\n\tif (config.projectAccessKey === '' || !config.projectAccessKey) {\n\t\tthrow new InvalidProjectAccessKeyError(config.projectAccessKey);\n\t}\n\n\tconst analytics = useMemo(() => {\n\t\tconst server = 'https://nodes.sequence.app';\n\t\tconst auth: Auth = {};\n\t\tauth.headers = { 'X-Access-Key': config.projectAccessKey };\n\n\t\treturn new DatabeatAnalytics(server, auth, {\n\t\t\tdefaultEnabled: true,\n\t\t\tinitProps: () => {\n\t\t\t\treturn {\n\t\t\t\t\torigin: typeof window !== 'undefined' ? window.location.origin : '',\n\t\t\t\t};\n\t\t\t},\n\t\t});\n\t}, [config.projectAccessKey, window]);\n\n\tif (openConnectModal) {\n\t\tconst context: MarketplaceSdkContextType = {\n\t\t\t...config,\n\t\t\topenConnectModal,\n\t\t\tanalytics,\n\t\t};\n\n\t\treturn (\n\t\t\t<MarketplaceQueryClientProvider>\n\t\t\t\t<MarketplaceSdkContext.Provider value={context}>\n\t\t\t\t\t<div id={PROVIDER_ID}>{children}</div>\n\t\t\t\t</MarketplaceSdkContext.Provider>\n\t\t\t</MarketplaceQueryClientProvider>\n\t\t);\n\t}\n\n\treturn (\n\t\t<MarketplaceProviderWithSequenceConnect\n\t\t\tconfig={config}\n\t\t\tanalytics={analytics}\n\t\t>\n\t\t\t{children}\n\t\t</MarketplaceProviderWithSequenceConnect>\n\t);\n}\n\nexport function MarketplaceQueryClientProvider({\n\tchildren,\n}: {\n\tchildren: React.ReactNode;\n}) {\n\tconst queryClient = getQueryClient();\n\treturn (\n\t\t<QueryClientProvider client={queryClient}>{children}</QueryClientProvider>\n\t);\n}\n\nfunction MarketplaceProviderWithSequenceConnect({\n\tconfig,\n\tchildren,\n\tanalytics,\n}: MarketplaceSdkProviderProps & { analytics: DatabeatAnalytics }) {\n\tconst { setOpenConnectModal } = useOpenConnectModal();\n\n\tconst context: MarketplaceSdkContextType = {\n\t\t...config,\n\t\topenConnectModal: () => setOpenConnectModal(true),\n\t\tanalytics,\n\t};\n\n\treturn (\n\t\t<MarketplaceQueryClientProvider>\n\t\t\t<MarketplaceSdkContext.Provider value={context}>\n\t\t\t\t<div id={PROVIDER_ID}>{children}</div>\n\t\t\t</MarketplaceSdkContext.Provider>\n\t\t</MarketplaceQueryClientProvider>\n\t);\n}\n"],"mappings":";;;;;;;;;;AAMA,IAAa,cAAb,cAAiC,UAAU;CAC1C,AAAS,OAAO;AAChB;AAED,IAAa,+BAAb,cAAkD,YAAY;CAC7D,AAAS,OAAO;CAChB,YAAYA,kBAA0B;AACrC,SAAO,8BAA8B,iBAAiB,EAAE;CACxD;AACD;;;;ACED,IAAa,oBAAb,cAAuC,SAAsC;CAC5E,eAAeC,MAAsB;AACpC,OAAK,MAAM;GACV,OAAO;GACP,OAAO,KAAK;GACZ,MAAM,KAAK;EACX,EAAC;CACF;CAED,oBAAoBC,MAA2B;AAC9C,OAAK,MAAM;GACV,OAAO;GACP,OAAO,KAAK;GACZ,MAAM,KAAK;EACX,EAAC;CACF;CAED,mBAAmBC,MAA0B;AAC5C,OAAK,MAAM;GACV,OAAO;GACP,OAAO,KAAK;GACZ,MAAM,KAAK;EACX,EAAC;CACF;CAED,iBAAiBC,MAAwB;AACxC,OAAK,MAAM;GACV,OAAO;GACP,OAAO,KAAK;GACZ,MAAM,KAAK;EACX,EAAC;CACF;CAED,uBAAuBC,MAA8B;AACpD,OAAK,MAAM;GACV,OAAO;GACP,OAAO;EACP,EAAC;CACF;AACD;AAED,MAAa,eAAe,MAAM;CACjC,MAAM,UAAU,WAAW,sBAAsB;AAEjD,QAAO,QAAQ;AACf;;;;AC/CD,MAAa,wBAAwB,cACpC,CAAE,EACF;AAQD,SAAgB,oBAAoB,EACnC,QACA,UACA,kBAC6B,EAAE;AAC/B,KAAI,OAAO,qBAAqB,OAAO,OAAO,iBAC7C,OAAM,IAAI,6BAA6B,OAAO;CAG/C,MAAM,YAAY,QAAQ,MAAM;EAC/B,MAAM,SAAS;EACf,MAAMC,OAAa,CAAE;AACrB,OAAK,UAAU,EAAE,gBAAgB,OAAO,iBAAkB;AAE1D,SAAO,IAAI,kBAAkB,QAAQ,MAAM;GAC1C,gBAAgB;GAChB,WAAW,MAAM;AAChB,WAAO,EACN,eAAe,WAAW,cAAc,OAAO,SAAS,SAAS,GACjE;GACD;EACD;CACD,GAAE,CAAC,OAAO,kBAAkB,MAAO,EAAC;AAErC,KAAI,kBAAkB;EACrB,MAAMC,UAAqC;GAC1C,GAAG;GACH;GACA;EACA;AAED,yBACC,IAAC,4DACA,IAAC,sBAAsB;GAAS,OAAO;6BACtC,IAAC;IAAI,IAAI;IAAc;KAAe;IACN,GACD;CAElC;AAED,wBACC,IAAC;EACQ;EACG;EAEV;GACuC;AAE1C;AAED,SAAgB,+BAA+B,EAC9C,UAGA,EAAE;CACF,MAAM,cAAc,gBAAgB;AACpC,wBACC,IAAC;EAAoB,QAAQ;EAAc;GAA+B;AAE3E;AAED,SAAS,uCAAuC,EAC/C,QACA,UACA,WACgE,EAAE;CAClE,MAAM,EAAE,qBAAqB,GAAG,qBAAqB;CAErD,MAAMA,UAAqC;EAC1C,GAAG;EACH,kBAAkB,MAAM,oBAAoB,KAAK;EACjD;CACA;AAED,wBACC,IAAC,4DACA,IAAC,sBAAsB;EAAS,OAAO;4BACtC,IAAC;GAAI,IAAI;GAAc;IAAe;GACN,GACD;AAElC"}