{"version":3,"file":"config.js","names":["marketplaceConfig: MarketplaceConfig"],"sources":["../src/react/_internal/query-meta.ts","../src/react/queries/marketplace/queryKeys.ts","../src/react/queries/marketplace/config.ts"],"sourcesContent":["export const persistentQueryMeta = {\n\tpersistent: true,\n};\n","import { serializeBigInts } from '../../_internal/utils';\n\n/**\n * Creates a type-safe query key for marketplace domain with automatic bigint serialization\n *\n * @param operation - The specific operation (e.g., 'config', 'filters')\n * @param params - The query parameters (will be automatically serialized)\n * @returns A serialized query key safe for React Query\n */\nexport function createMarketplaceQueryKey<T>(operation: string, params: T) {\n\treturn ['marketplace', operation, serializeBigInts(params)] as const;\n}\n","import type { Builder } from '@0xsequence/api-client';\nimport { queryOptions } from '@tanstack/react-query';\nimport type { MarketplaceConfig, SdkConfig } from '../../../types';\nimport { getBuilderClient } from '../../_internal';\nimport { persistentQueryMeta } from '../../_internal/query-meta';\nimport { createMarketplaceQueryKey } from './queryKeys';\n\nexport const fetchMarketplaceConfig = async ({\n\tconfig,\n\tprefetchedMarketplaceSettings,\n}: {\n\tconfig: SdkConfig;\n\tprefetchedMarketplaceSettings?: Builder.LookupMarketplaceReturn;\n}): Promise<MarketplaceConfig> => {\n\tlet builderMarketplaceConfig = prefetchedMarketplaceSettings;\n\n\tif (!builderMarketplaceConfig) {\n\t\tconst builderApi = getBuilderClient(config);\n\t\tconst response = await builderApi.lookupMarketplace({\n\t\t\tprojectId: Number(config.projectId),\n\t\t});\n\n\t\tbuilderMarketplaceConfig = response;\n\t}\n\n\tif (!builderMarketplaceConfig) {\n\t\tthrow new Error('Failed to fetch marketplace config');\n\t}\n\n\t// The API wrapper's toLookupMarketplaceReturn transform already:\n\t// 1. Nests collections within market.collections and shop.collections\n\t// 2. Adds marketplaceCollectionType discriminator to each collection\n\t// 3. Returns correctly typed MarketPage and ShopPage interfaces\n\t// No transformation or type casting needed here!\n\tconst { market, shop, settings } = builderMarketplaceConfig.marketplace;\n\n\tlet marketplaceConfig: MarketplaceConfig = {\n\t\tprojectId: Number(config.projectId),\n\t\tsettings,\n\t\tmarket,\n\t\tshop,\n\t};\n\n\tif (config._internal?.overrides?.marketplaceConfig) {\n\t\tconst overrides = config._internal.overrides.marketplaceConfig;\n\t\tmarketplaceConfig = {\n\t\t\t...marketplaceConfig,\n\t\t\t...overrides,\n\t\t\tmarket: {\n\t\t\t\t...marketplaceConfig.market,\n\t\t\t\t...overrides.market,\n\t\t\t\tcollections:\n\t\t\t\t\toverrides.market?.collections ?? marketplaceConfig.market.collections,\n\t\t\t},\n\t\t\tshop: {\n\t\t\t\t...marketplaceConfig.shop,\n\t\t\t\t...overrides.shop,\n\t\t\t\tcollections:\n\t\t\t\t\toverrides.shop?.collections ?? marketplaceConfig.shop.collections,\n\t\t\t},\n\t\t};\n\t}\n\n\treturn marketplaceConfig;\n};\n\nexport const marketplaceConfigOptions = (config: SdkConfig) => {\n\tconst prefetchedMarketplaceSettings =\n\t\tconfig._internal?.prefetchedMarketplaceSettings;\n\n\treturn queryOptions({\n\t\tqueryKey: createMarketplaceQueryKey('config', {}),\n\t\tqueryFn: () =>\n\t\t\tfetchMarketplaceConfig({\n\t\t\t\tconfig,\n\t\t\t\tprefetchedMarketplaceSettings,\n\t\t\t}),\n\t\tgcTime: Number.POSITIVE_INFINITY,\n\t\tstaleTime: Number.POSITIVE_INFINITY,\n\t\trefetchOnMount: false,\n\t\trefetchOnReconnect: false,\n\t\trefetchOnWindowFocus: false,\n\t\tmeta: persistentQueryMeta,\n\t});\n};\n"],"mappings":";;;;;AAAA,MAAa,sBAAsB,EAClC,YAAY,MACZ;;;;;;;;;;;ACOD,SAAgB,0BAA6B,WAAmB,QAAW;AAC1E,QAAO;EAAC;EAAe;EAAW,iBAAiB,OAAO;EAAC;;;;;ACH5D,MAAa,yBAAyB,OAAO,EAC5C,QACA,oCAIiC;CACjC,IAAI,2BAA2B;AAE/B,KAAI,CAAC,yBAMJ,4BAJiB,MADE,iBAAiB,OAAO,CACT,kBAAkB,EACnD,WAAW,OAAO,OAAO,UAAU,EACnC,CAAC;AAKH,KAAI,CAAC,yBACJ,OAAM,IAAI,MAAM,qCAAqC;CAQtD,MAAM,EAAE,QAAQ,MAAM,aAAa,yBAAyB;CAE5D,IAAIA,oBAAuC;EAC1C,WAAW,OAAO,OAAO,UAAU;EACnC;EACA;EACA;EACA;AAED,KAAI,OAAO,WAAW,WAAW,mBAAmB;EACnD,MAAM,YAAY,OAAO,UAAU,UAAU;AAC7C,sBAAoB;GACnB,GAAG;GACH,GAAG;GACH,QAAQ;IACP,GAAG,kBAAkB;IACrB,GAAG,UAAU;IACb,aACC,UAAU,QAAQ,eAAe,kBAAkB,OAAO;IAC3D;GACD,MAAM;IACL,GAAG,kBAAkB;IACrB,GAAG,UAAU;IACb,aACC,UAAU,MAAM,eAAe,kBAAkB,KAAK;IACvD;GACD;;AAGF,QAAO;;AAGR,MAAa,4BAA4B,WAAsB;CAC9D,MAAM,gCACL,OAAO,WAAW;AAEnB,QAAO,aAAa;EACnB,UAAU,0BAA0B,UAAU,EAAE,CAAC;EACjD,eACC,uBAAuB;GACtB;GACA;GACA,CAAC;EACH,QAAQ,OAAO;EACf,WAAW,OAAO;EAClB,gBAAgB;EAChB,oBAAoB;EACpB,sBAAsB;EACtB,MAAM;EACN,CAAC"}