{"version":3,"file":"api.js","names":["browserQueryClient: QueryClient | undefined","result: any","authenticatedFetch: typeof globalThis.fetch","headers: Record<string, string>","SequenceMetadata","SequenceIndexer"],"sources":["../src/react/_internal/api/get-query-client.ts","../src/react/_internal/utils.ts","../src/react/_internal/api/marketplace-api.ts","../src/react/_internal/api/services.ts"],"sourcesContent":["import {\n\tdefaultShouldDehydrateQuery,\n\tQueryClient,\n} from '@tanstack/react-query';\nimport { hashFn } from 'wagmi/query';\n\nfunction makeQueryClient() {\n\treturn new QueryClient({\n\t\tdefaultOptions: {\n\t\t\tqueries: {\n\t\t\t\tstaleTime: 60 * 1000,\n\t\t\t\tqueryKeyHashFn: hashFn,\n\t\t\t},\n\t\t\tdehydrate: {\n\t\t\t\tshouldDehydrateQuery: (query) =>\n\t\t\t\t\tdefaultShouldDehydrateQuery(query) ||\n\t\t\t\t\tquery.state.status === 'pending',\n\t\t\t},\n\t\t},\n\t});\n}\n\nlet browserQueryClient: QueryClient | undefined;\n\nexport function getQueryClient() {\n\tif (typeof globalThis.document === 'undefined') {\n\t\treturn makeQueryClient();\n\t}\n\n\tif (!browserQueryClient) browserQueryClient = makeQueryClient();\n\treturn browserQueryClient;\n}\n","export {\n\ttype ApprovalStep,\n\tisSignatureStep,\n\tisTransactionStep,\n\ttype SignatureStep,\n\ttype TransactionStep,\n} from '@0xsequence/api-client';\n\nexport const clamp = (val: number, min: number, max: number) =>\n\tMath.max(min, Math.min(max, val));\n\n/**\n * Recursively converts all bigint values to strings in an object\n * This is needed for React Query keys which must be JSON-serializable\n */\nexport function serializeBigInts<T>(obj: T): T {\n\tif (obj === null || obj === undefined) return obj;\n\n\tif (typeof obj === 'bigint') {\n\t\treturn obj.toString() as T;\n\t}\n\n\tif (Array.isArray(obj)) {\n\t\treturn obj.map(serializeBigInts) as T;\n\t}\n\n\tif (typeof obj === 'object') {\n\t\t// eslint-disable-next-line @typescript-eslint/no-explicit-any -- Dynamic object reconstruction requires any\n\t\tconst result: any = {};\n\t\tfor (const key in obj) {\n\t\t\tif (Object.hasOwn(obj, key)) {\n\t\t\t\tresult[key] = serializeBigInts(obj[key]);\n\t\t\t}\n\t\t}\n\t\treturn result as T;\n\t}\n\n\treturn obj;\n}\n","import { MarketplaceClient } from '@0xsequence/api-client';\nimport { serializeBigInts } from '../utils';\n\nexport class SequenceMarketplace extends MarketplaceClient {\n\tpublic projectAccessKey: string;\n\tpublic jwtAuth?: string;\n\n\tconstructor(hostname: string, projectAccessKey: string, jwtAuth?: string) {\n\t\t// Create custom fetch function with auth headers\n\t\tconst authenticatedFetch: typeof globalThis.fetch = (\n\t\t\tinput: RequestInfo | URL,\n\t\t\tinit?: RequestInit,\n\t\t): Promise<Response> => {\n\t\t\tconst headers: Record<string, string> = {};\n\n\t\t\tif (jwtAuth && jwtAuth.length > 0) {\n\t\t\t\theaders.Authorization = `BEARER ${jwtAuth}`;\n\t\t\t}\n\n\t\t\tif (projectAccessKey && projectAccessKey.length > 0) {\n\t\t\t\theaders['X-Access-Key'] = projectAccessKey;\n\t\t\t}\n\n\t\t\tconst requestInit = init || {};\n\t\t\trequestInit.headers = { ...init?.headers, ...headers };\n\n\t\t\treturn fetch(input, requestInit);\n\t\t};\n\n\t\tsuper(\n\t\t\thostname.endsWith('/') ? hostname.slice(0, -1) : hostname,\n\t\t\tauthenticatedFetch,\n\t\t);\n\n\t\tthis.projectAccessKey = projectAccessKey;\n\t\tthis.jwtAuth = jwtAuth;\n\n\t\t// Wrap the parent's queryKey object to automatically serialize bigint values\n\t\tconst parentQueryKey = this.queryKey;\n\t\tthis.queryKey = new Proxy(parentQueryKey, {\n\t\t\tget: (target, prop: string) => {\n\t\t\t\tconst originalMethod = target[prop as keyof typeof target];\n\t\t\t\tif (typeof originalMethod === 'function') {\n\t\t\t\t\t// biome-ignore lint/suspicious/noExplicitAny: Required for proxy wrapper to handle any query key method signature\n\t\t\t\t\t// eslint-disable-next-line @typescript-eslint/no-explicit-any -- Required for proxy wrapper to handle any query key method signature\n\t\t\t\t\treturn (req: any) => {\n\t\t\t\t\t\tconst result = originalMethod(req);\n\t\t\t\t\t\t// Query keys from the RPC client are tuples like [\"Marketplace\", \"methodName\", params]\n\t\t\t\t\t\t// We need to serialize the params (3rd element)\n\t\t\t\t\t\tif (Array.isArray(result) && result.length === 3) {\n\t\t\t\t\t\t\treturn [\n\t\t\t\t\t\t\t\tresult[0],\n\t\t\t\t\t\t\t\tresult[1],\n\t\t\t\t\t\t\t\tserializeBigInts(result[2]),\n\t\t\t\t\t\t\t] as const;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn result;\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\treturn originalMethod;\n\t\t\t},\n\t\t});\n\t}\n}\n","import { SequenceAPIClient } from '@0xsequence/api';\nimport { SequenceIndexer, SequenceMetadata } from '@0xsequence/api-client';\nimport { stringTemplate } from '@0xsequence/network';\nimport type { ApiConfig, Env, SdkConfig } from '../../../types/sdk-config';\nimport { getNetwork } from '../../../utils/network';\nimport { BuilderAPI } from './builder-api';\nimport { SequenceMarketplace } from './marketplace-api';\n\nconst SERVICES = {\n\t// biome-ignore lint/suspicious/noTemplateCurlyInString: template placeholder for stringTemplate function\n\tsequenceApi: 'https://${prefix}api.sequence.app',\n\t// biome-ignore lint/suspicious/noTemplateCurlyInString: template placeholder for stringTemplate function\n\tmetadata: 'https://${prefix}metadata.sequence.app',\n\t// biome-ignore lint/suspicious/noTemplateCurlyInString: template placeholder for stringTemplate function\n\tindexer: 'https://${prefix}${network}-indexer.sequence.app',\n\t// biome-ignore lint/suspicious/noTemplateCurlyInString: template placeholder for stringTemplate function\n\tindexerGateway: 'https://${prefix}indexer.sequence.app',\n\t// biome-ignore lint/suspicious/noTemplateCurlyInString: template placeholder for stringTemplate function\n\tnodeGateway: 'https://${prefix}nodes.sequence.app',\n\t// biome-ignore lint/suspicious/noTemplateCurlyInString: template placeholder for stringTemplate function\n\tmarketplaceApi: 'https://${prefix}marketplace-api.sequence.app',\n\t// biome-ignore lint/suspicious/noTemplateCurlyInString: template placeholder for stringTemplate function\n\tbuilderRpcApi: 'https://${prefix}api.sequence.build',\n\t// biome-ignore lint/suspicious/noTemplateCurlyInString: template placeholder for stringTemplate function\n\ttrailsApi: 'https://${prefix}trails-api.sequence${postfix}.app',\n};\n\ntype ChainNameOrId = string | number;\n\nconst metadataURL = (env: Env = 'production') => {\n\tconst prefix = getPrefix(env);\n\treturn stringTemplate(SERVICES.metadata, { prefix });\n};\n\nexport const indexerURL = (chain: ChainNameOrId, env: Env = 'production') => {\n\tconst prefix = getPrefix(env);\n\tconst network = getNetwork(chain).name;\n\treturn stringTemplate(SERVICES.indexer, { network, prefix });\n};\n\nexport const marketplaceApiURL = (env: Env = 'production') => {\n\tconst prefix = getPrefix(env);\n\treturn stringTemplate(SERVICES.marketplaceApi, { prefix });\n};\n\nconst builderRpcApiURL = (env: Env = 'production') => {\n\tconst prefix = getPrefix(env);\n\treturn stringTemplate(SERVICES.builderRpcApi, { prefix });\n};\n\nexport const sequenceApiUrl = (env: Env = 'production') => {\n\tconst prefix = getPrefix(env);\n\treturn stringTemplate(SERVICES.sequenceApi, { prefix });\n};\n\nconst trailsApiURL = (env: Env = 'production') => {\n\tconst prefix = getPrefix(env);\n\tconst postfix = getPostfix(env);\n\treturn stringTemplate(SERVICES.trailsApi, { prefix, postfix });\n};\n\nconst indexerGatewayURL = (env: Env = 'production') => {\n\tconst prefix = getPrefix(env);\n\treturn stringTemplate(SERVICES.indexerGateway, { prefix });\n};\n\nconst nodeGatewayURL = (env: Env = 'production') => {\n\tconst prefix = getPrefix(env);\n\treturn stringTemplate(SERVICES.nodeGateway, { prefix });\n};\n\nexport const getBuilderClient = (config: SdkConfig) => {\n\tconst overrides = config._internal?.overrides?.api?.builder;\n\tconst url =\n\t\toverrides?.url || builderRpcApiURL(overrides?.env || 'production');\n\tconst projectAccessKey = overrides?.accessKey || config.projectAccessKey;\n\treturn new BuilderAPI(url, projectAccessKey);\n};\n\nexport const getMetadataClient = (config: SdkConfig) => {\n\tconst overrides = config._internal?.overrides?.api?.metadata;\n\tconst url = overrides?.url || metadataURL(overrides?.env || 'production');\n\tconst projectAccessKey = overrides?.accessKey || config.projectAccessKey;\n\treturn new SequenceMetadata(url, projectAccessKey);\n};\n\nexport const getIndexerClient = (chain: ChainNameOrId, config: SdkConfig) => {\n\tconst overrides = config._internal?.overrides?.api?.indexer;\n\tconst url =\n\t\toverrides?.url || indexerURL(chain, overrides?.env || 'production');\n\tconst projectAccessKey = overrides?.accessKey || config.projectAccessKey;\n\treturn new SequenceIndexer(url, projectAccessKey);\n};\n\nexport const getMarketplaceClient = (config: SdkConfig) => {\n\tconst overrides = config._internal?.overrides?.api?.marketplace;\n\tconst url =\n\t\toverrides?.url || marketplaceApiURL(overrides?.env || 'production');\n\tconst projectAccessKey = overrides?.accessKey || config.projectAccessKey;\n\treturn new SequenceMarketplace(url, projectAccessKey);\n};\n\nexport const getSequenceApiClient = (config: SdkConfig) => {\n\tconst overrides = config._internal?.overrides?.api?.sequenceApi;\n\tconst url = overrides?.url || sequenceApiUrl(overrides?.env || 'production');\n\tconst projectAccessKey = overrides?.accessKey || config.projectAccessKey;\n\treturn new SequenceAPIClient(url, projectAccessKey);\n};\n\nexport const getTrailsApiUrl = (config: SdkConfig) => {\n\tconst overrides = config._internal?.overrides?.api?.trails;\n\treturn overrides?.url || trailsApiURL(overrides?.env || 'production');\n};\n\nexport const getSequenceIndexerUrl = (config: SdkConfig) => {\n\tconst overrides = config._internal?.overrides?.api?.indexer;\n\treturn overrides?.url || indexerGatewayURL(overrides?.env || 'production');\n};\n\nexport const getSequenceNodeGatewayUrl = (config: SdkConfig) => {\n\tconst overrides = config._internal?.overrides?.api?.nodeGateway;\n\treturn overrides?.url || nodeGatewayURL(overrides?.env || 'production');\n};\n\nexport const getSequenceApiUrl = (config: SdkConfig) => {\n\tconst overrides = config._internal?.overrides?.api?.sequenceApi;\n\treturn overrides?.url || sequenceApiUrl(overrides?.env || 'production');\n};\n\nconst getPrefix = (env: ApiConfig['env']) => {\n\tswitch (env) {\n\t\tcase 'development':\n\t\t\treturn 'dev-';\n\t\tcase 'production':\n\t\t\treturn '';\n\t\tcase 'next':\n\t\t\treturn 'next-';\n\t}\n};\n\nconst getPostfix = (env: ApiConfig['env']) => {\n\tswitch (env) {\n\t\tcase 'development':\n\t\t\treturn '-dev';\n\t\tcase 'production':\n\t\t\treturn '';\n\t\tcase 'next':\n\t\t\treturn '-next';\n\t}\n};\n"],"mappings":";;;;;;;;;AAMA,SAAS,kBAAkB;AAC1B,QAAO,IAAI,YAAY,EACtB,gBAAgB;EACf,SAAS;GACR,WAAW,KAAK;GAChB,gBAAgB;GAChB;EACD,WAAW,EACV,uBAAuB,UACtB,4BAA4B,MAAM,IAClC,MAAM,MAAM,WAAW,WACxB;EACD,EACD,CAAC;;AAGH,IAAIA;AAEJ,SAAgB,iBAAiB;AAChC,KAAI,OAAO,WAAW,aAAa,YAClC,QAAO,iBAAiB;AAGzB,KAAI,CAAC,mBAAoB,sBAAqB,iBAAiB;AAC/D,QAAO;;;;;ACtBR,MAAa,SAAS,KAAa,KAAa,QAC/C,KAAK,IAAI,KAAK,KAAK,IAAI,KAAK,IAAI,CAAC;;;;;AAMlC,SAAgB,iBAAoB,KAAW;AAC9C,KAAI,QAAQ,QAAQ,QAAQ,OAAW,QAAO;AAE9C,KAAI,OAAO,QAAQ,SAClB,QAAO,IAAI,UAAU;AAGtB,KAAI,MAAM,QAAQ,IAAI,CACrB,QAAO,IAAI,IAAI,iBAAiB;AAGjC,KAAI,OAAO,QAAQ,UAAU;EAE5B,MAAMC,SAAc,EAAE;AACtB,OAAK,MAAM,OAAO,IACjB,KAAI,OAAO,OAAO,KAAK,IAAI,CAC1B,QAAO,OAAO,iBAAiB,IAAI,KAAK;AAG1C,SAAO;;AAGR,QAAO;;;;;AClCR,IAAa,sBAAb,cAAyC,kBAAkB;CAC1D,AAAO;CACP,AAAO;CAEP,YAAY,UAAkB,kBAA0B,SAAkB;EAEzE,MAAMC,sBACL,OACA,SACuB;GACvB,MAAMC,UAAkC,EAAE;AAE1C,OAAI,WAAW,QAAQ,SAAS,EAC/B,SAAQ,gBAAgB,UAAU;AAGnC,OAAI,oBAAoB,iBAAiB,SAAS,EACjD,SAAQ,kBAAkB;GAG3B,MAAM,cAAc,QAAQ,EAAE;AAC9B,eAAY,UAAU;IAAE,GAAG,MAAM;IAAS,GAAG;IAAS;AAEtD,UAAO,MAAM,OAAO,YAAY;;AAGjC,QACC,SAAS,SAAS,IAAI,GAAG,SAAS,MAAM,GAAG,GAAG,GAAG,UACjD,mBACA;AAED,OAAK,mBAAmB;AACxB,OAAK,UAAU;EAGf,MAAM,iBAAiB,KAAK;AAC5B,OAAK,WAAW,IAAI,MAAM,gBAAgB,EACzC,MAAM,QAAQ,SAAiB;GAC9B,MAAM,iBAAiB,OAAO;AAC9B,OAAI,OAAO,mBAAmB,WAG7B,SAAQ,QAAa;IACpB,MAAM,SAAS,eAAe,IAAI;AAGlC,QAAI,MAAM,QAAQ,OAAO,IAAI,OAAO,WAAW,EAC9C,QAAO;KACN,OAAO;KACP,OAAO;KACP,iBAAiB,OAAO,GAAG;KAC3B;AAEF,WAAO;;AAGT,UAAO;KAER,CAAC;;;;;;ACrDJ,MAAM,WAAW;CAEhB,aAAa;CAEb,UAAU;CAEV,SAAS;CAET,gBAAgB;CAEhB,aAAa;CAEb,gBAAgB;CAEhB,eAAe;CAEf,WAAW;CACX;AAID,MAAM,eAAe,MAAW,iBAAiB;CAChD,MAAM,SAAS,UAAU,IAAI;AAC7B,QAAO,eAAe,SAAS,UAAU,EAAE,QAAQ,CAAC;;AAGrD,MAAa,cAAc,OAAsB,MAAW,iBAAiB;CAC5E,MAAM,SAAS,UAAU,IAAI;CAC7B,MAAM,UAAU,WAAW,MAAM,CAAC;AAClC,QAAO,eAAe,SAAS,SAAS;EAAE;EAAS;EAAQ,CAAC;;AAG7D,MAAa,qBAAqB,MAAW,iBAAiB;CAC7D,MAAM,SAAS,UAAU,IAAI;AAC7B,QAAO,eAAe,SAAS,gBAAgB,EAAE,QAAQ,CAAC;;AAG3D,MAAM,oBAAoB,MAAW,iBAAiB;CACrD,MAAM,SAAS,UAAU,IAAI;AAC7B,QAAO,eAAe,SAAS,eAAe,EAAE,QAAQ,CAAC;;AAG1D,MAAa,kBAAkB,MAAW,iBAAiB;CAC1D,MAAM,SAAS,UAAU,IAAI;AAC7B,QAAO,eAAe,SAAS,aAAa,EAAE,QAAQ,CAAC;;AAGxD,MAAM,gBAAgB,MAAW,iBAAiB;CACjD,MAAM,SAAS,UAAU,IAAI;CAC7B,MAAM,UAAU,WAAW,IAAI;AAC/B,QAAO,eAAe,SAAS,WAAW;EAAE;EAAQ;EAAS,CAAC;;AAG/D,MAAM,qBAAqB,MAAW,iBAAiB;CACtD,MAAM,SAAS,UAAU,IAAI;AAC7B,QAAO,eAAe,SAAS,gBAAgB,EAAE,QAAQ,CAAC;;AAG3D,MAAM,kBAAkB,MAAW,iBAAiB;CACnD,MAAM,SAAS,UAAU,IAAI;AAC7B,QAAO,eAAe,SAAS,aAAa,EAAE,QAAQ,CAAC;;AAGxD,MAAa,oBAAoB,WAAsB;CACtD,MAAM,YAAY,OAAO,WAAW,WAAW,KAAK;AAIpD,QAAO,IAAI,WAFV,WAAW,OAAO,iBAAiB,WAAW,OAAO,aAAa,EAC1C,WAAW,aAAa,OAAO,iBACZ;;AAG7C,MAAa,qBAAqB,WAAsB;CACvD,MAAM,YAAY,OAAO,WAAW,WAAW,KAAK;AAGpD,QAAO,IAAIC,eAFC,WAAW,OAAO,YAAY,WAAW,OAAO,aAAa,EAChD,WAAW,aAAa,OAAO,iBACN;;AAGnD,MAAa,oBAAoB,OAAsB,WAAsB;CAC5E,MAAM,YAAY,OAAO,WAAW,WAAW,KAAK;AAIpD,QAAO,IAAIC,cAFV,WAAW,OAAO,WAAW,OAAO,WAAW,OAAO,aAAa,EAC3C,WAAW,aAAa,OAAO,iBACP;;AAGlD,MAAa,wBAAwB,WAAsB;CAC1D,MAAM,YAAY,OAAO,WAAW,WAAW,KAAK;AAIpD,QAAO,IAAI,oBAFV,WAAW,OAAO,kBAAkB,WAAW,OAAO,aAAa,EAC3C,WAAW,aAAa,OAAO,iBACH;;AAGtD,MAAa,wBAAwB,WAAsB;CAC1D,MAAM,YAAY,OAAO,WAAW,WAAW,KAAK;AAGpD,QAAO,IAAI,kBAFC,WAAW,OAAO,eAAe,WAAW,OAAO,aAAa,EACnD,WAAW,aAAa,OAAO,iBACL;;AAGpD,MAAa,mBAAmB,WAAsB;CACrD,MAAM,YAAY,OAAO,WAAW,WAAW,KAAK;AACpD,QAAO,WAAW,OAAO,aAAa,WAAW,OAAO,aAAa;;AAGtE,MAAa,yBAAyB,WAAsB;CAC3D,MAAM,YAAY,OAAO,WAAW,WAAW,KAAK;AACpD,QAAO,WAAW,OAAO,kBAAkB,WAAW,OAAO,aAAa;;AAG3E,MAAa,6BAA6B,WAAsB;CAC/D,MAAM,YAAY,OAAO,WAAW,WAAW,KAAK;AACpD,QAAO,WAAW,OAAO,eAAe,WAAW,OAAO,aAAa;;AAGxE,MAAa,qBAAqB,WAAsB;CACvD,MAAM,YAAY,OAAO,WAAW,WAAW,KAAK;AACpD,QAAO,WAAW,OAAO,eAAe,WAAW,OAAO,aAAa;;AAGxE,MAAM,aAAa,QAA0B;AAC5C,SAAQ,KAAR;EACC,KAAK,cACJ,QAAO;EACR,KAAK,aACJ,QAAO;EACR,KAAK,OACJ,QAAO;;;AAIV,MAAM,cAAc,QAA0B;AAC7C,SAAQ,KAAR;EACC,KAAK,cACJ,QAAO;EACR,KAAK,aACJ,QAAO;EACR,KAAK,OACJ,QAAO"}