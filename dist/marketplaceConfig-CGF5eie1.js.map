{"version":3,"file":"marketplaceConfig-CGF5eie1.js","names":[],"sources":["../src/react/_internal/query-meta.ts","../src/react/queries/marketplaceConfig.ts"],"sourcesContent":["export const persistentQueryMeta = {\n\tpersistent: true,\n};\n","import { queryOptions } from '@tanstack/react-query';\nimport type { Address } from 'viem';\nimport type { ContractType, OrderbookKind, SdkConfig } from '../../types';\nimport type {\n\tMarketCollection,\n\tMarketPage,\n\tMarketplaceConfig,\n\tShopCollection,\n\tShopPage,\n} from '../../types/new-marketplace-types';\nimport { configKeys, getBuilderClient } from '../_internal';\nimport type { LookupMarketplaceReturn } from '../_internal/api/builder.gen';\nimport { persistentQueryMeta } from '../_internal/query-meta';\n\nexport const fetchMarketplaceConfig = async ({\n\tconfig,\n\tprefetchedMarketplaceSettings,\n}: {\n\tconfig: SdkConfig;\n\tprefetchedMarketplaceSettings?: LookupMarketplaceReturn;\n}): Promise<MarketplaceConfig> => {\n\tlet builderMarketplaceConfig = prefetchedMarketplaceSettings;\n\n\tif (!builderMarketplaceConfig) {\n\t\tconst builderApi = getBuilderClient(config);\n\t\tconst response = await builderApi.lookupMarketplace({\n\t\t\tprojectId: Number(config.projectId),\n\t\t});\n\n\t\tbuilderMarketplaceConfig = response;\n\t}\n\n\tconst marketCollections = (\n\t\tbuilderMarketplaceConfig.marketCollections ?? []\n\t).map((collection) => {\n\t\treturn {\n\t\t\t...collection,\n\t\t\tcontractType: collection.contractType as ContractType,\n\t\t\tdestinationMarketplace:\n\t\t\t\tcollection.destinationMarketplace as OrderbookKind,\n\t\t\titemsAddress: collection.itemsAddress as Address,\n\t\t\tcardType: 'market',\n\t\t} satisfies MarketCollection;\n\t});\n\n\tconst shopCollections = (builderMarketplaceConfig.shopCollections ?? []).map(\n\t\t(collection) => {\n\t\t\treturn {\n\t\t\t\t...collection,\n\t\t\t\titemsAddress: collection.itemsAddress as Address,\n\t\t\t\tsaleAddress: collection.saleAddress as Address,\n\t\t\t\tcardType: 'shop',\n\t\t\t} satisfies ShopCollection;\n\t\t},\n\t);\n\n\tconst market = {\n\t\t...builderMarketplaceConfig.marketplace.market,\n\t\tcollections: marketCollections,\n\t} satisfies MarketPage;\n\n\tconst shop = {\n\t\t...builderMarketplaceConfig.marketplace.shop,\n\t\tcollections: shopCollections ?? [],\n\t} satisfies ShopPage;\n\n\tlet marketplaceConfig = {\n\t\tprojectId: Number(config.projectId),\n\t\tsettings: builderMarketplaceConfig.marketplace.settings,\n\t\tmarket,\n\t\tshop,\n\t} satisfies MarketplaceConfig;\n\n\tif (config._internal?.overrides?.marketplaceConfig) {\n\t\tconst overrides = config._internal.overrides.marketplaceConfig;\n\t\tmarketplaceConfig = {\n\t\t\t...marketplaceConfig,\n\t\t\t...overrides,\n\t\t\tmarket: {\n\t\t\t\t...marketplaceConfig.market,\n\t\t\t\t...overrides.market,\n\t\t\t\t//@ts-expect-error - TODO: Fix this partial type. We need to align new-marketplace-types with builder.gen.ts\n\t\t\t\tcollections:\n\t\t\t\t\toverrides.market?.collections ?? marketplaceConfig.market.collections,\n\t\t\t},\n\t\t\tshop: {\n\t\t\t\t...marketplaceConfig.shop,\n\t\t\t\t...overrides.shop,\n\t\t\t\t//@ts-expect-error - TODO: Fix this partial type. We need to align new-marketplace-types with builder.gen.ts\n\t\t\t\tcollections:\n\t\t\t\t\toverrides.shop?.collections ?? marketplaceConfig.shop.collections,\n\t\t\t},\n\t\t};\n\t}\n\n\treturn marketplaceConfig;\n};\n\nexport const marketplaceConfigOptions = (config: SdkConfig) => {\n\tconst prefetchedMarketplaceSettings =\n\t\tconfig._internal?.prefetchedMarketplaceSettings;\n\n\treturn queryOptions({\n\t\tqueryKey: [...configKeys.marketplace],\n\t\tqueryFn: () =>\n\t\t\tfetchMarketplaceConfig({\n\t\t\t\tconfig,\n\t\t\t\tprefetchedMarketplaceSettings,\n\t\t\t}),\n\t\tgcTime: Number.POSITIVE_INFINITY,\n\t\tstaleTime: Number.POSITIVE_INFINITY,\n\t\trefetchOnMount: false,\n\t\trefetchOnReconnect: false,\n\t\trefetchOnWindowFocus: false,\n\t\tmeta: persistentQueryMeta,\n\t});\n};\n"],"mappings":";;;;AAAA,MAAa,sBAAsB,EAClC,YAAY,MACZ;;;;ACYD,MAAa,yBAAyB,OAAO,EAC5C,QACA,oCAIiC;CACjC,IAAI,2BAA2B;AAE/B,KAAI,CAAC,yBAMJ,4BAJiB,MADE,iBAAiB,OAAO,CACT,kBAAkB,EACnD,WAAW,OAAO,OAAO,UAAU,EACnC,CAAC;CAKH,MAAM,qBACL,yBAAyB,qBAAqB,EAAE,EAC/C,KAAK,eAAe;AACrB,SAAO;GACN,GAAG;GACH,cAAc,WAAW;GACzB,wBACC,WAAW;GACZ,cAAc,WAAW;GACzB,UAAU;GACV;GACA;CAEF,MAAM,mBAAmB,yBAAyB,mBAAmB,EAAE,EAAE,KACvE,eAAe;AACf,SAAO;GACN,GAAG;GACH,cAAc,WAAW;GACzB,aAAa,WAAW;GACxB,UAAU;GACV;GAEF;CAED,MAAM,SAAS;EACd,GAAG,yBAAyB,YAAY;EACxC,aAAa;EACb;CAED,MAAM,OAAO;EACZ,GAAG,yBAAyB,YAAY;EACxC,aAAa,mBAAmB,EAAE;EAClC;CAED,IAAI,oBAAoB;EACvB,WAAW,OAAO,OAAO,UAAU;EACnC,UAAU,yBAAyB,YAAY;EAC/C;EACA;EACA;AAED,KAAI,OAAO,WAAW,WAAW,mBAAmB;EACnD,MAAM,YAAY,OAAO,UAAU,UAAU;AAC7C,sBAAoB;GACnB,GAAG;GACH,GAAG;GACH,QAAQ;IACP,GAAG,kBAAkB;IACrB,GAAG,UAAU;IAEb,aACC,UAAU,QAAQ,eAAe,kBAAkB,OAAO;IAC3D;GACD,MAAM;IACL,GAAG,kBAAkB;IACrB,GAAG,UAAU;IAEb,aACC,UAAU,MAAM,eAAe,kBAAkB,KAAK;IACvD;GACD;;AAGF,QAAO;;AAGR,MAAa,4BAA4B,WAAsB;CAC9D,MAAM,gCACL,OAAO,WAAW;AAEnB,QAAO,aAAa;EACnB,UAAU,CAAC,GAAG,WAAW,YAAY;EACrC,eACC,uBAAuB;GACtB;GACA;GACA,CAAC;EACH,QAAQ,OAAO;EACf,WAAW,OAAO;EAClB,gBAAgB;EAChB,oBAAoB;EACpB,sBAAsB;EACtB,MAAM;EACN,CAAC"}